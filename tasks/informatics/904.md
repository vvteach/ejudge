---
title: "Задача №904. Локальная сеть"
tags:
  - problems/origin/informatics/904
---
# Задача №904. Локальная сеть

|  |  |
| --- | --- |
| Максимальное время работы на одном тесте: | 4 секунды |
| Максимальный объем используемой памяти: | 64 мегабайта |
Алексей
работает системным администратором в локальной домовой сети. Его сеть соединяет
множество квартир и располагается в нескольких зданиях.
Сеть
постоянно расширяется и Алексею поручено проложить новый участок сети. У него
есть схема, на которой указаны все возможные соединения между парами квартир и
для каждого соединения он знает длину провода, необходимого для его прокладки.
Его цель состоит в том, чтобы все квартиры были подключены к сети (возможно
через другие квартиры).
Компания,
в которой работает Алексей покупает кабель только в одном специализированном магазине.
В магазине продается кабель пятой и шестой категорий по цене P5 и P6 рублей за
метр. При этом в наличии имеется только Q5 метров кабеля пятой категории и Q6
метров кабеля шестой категории.
Алексею
необходимо составить план постройки сети с наименьшими затратами. План
представляет собой список соединений между квартирами, при этом каждому
соединению должно быть приписано, кабель какой категории будет проложен между
этими квартирами (пятой или шестой). Стоимость прокладки этой сети равна сумме
стоимости прокладки всех соединений. Общая длина кабеля каждой категории не
должна превышать количество кабеля, имеющегося в магазине.
***Входные данные***
В
первой строке входного файла содержится число N — количество квартир, которые
необходимо соединить и M — количество возможных соединений (1 *≤* *N* *≤* 1000, 1 *≤* *M* *≤* 10 000).
Следующие
M строк содержат описание возможных соединений. Каждое описание состоит из трех
чисел A, B и L — где A и B задают номера квартир, а L — длина соединения между
ними (1 *≤* L ≤
100). Квартиры занумерованы от 1 до N.
Последняя строка входного файла содержит числа P5, Q5, P6, Q6 – цену и количество
кабеля пятой и шестой категории соответственно (1 *≤* P, Q *≤* 10 000) .
***Выходные данные***
Если
все квартиры можно соединить в сеть, то следует вывести N строк, описывающих
план сети. Первая строка должна содержать стоимость прокладки сети. Следующие
N-1 строк должны содержать описание соединений, представленных двумя числами
каждое: Ai и Ci, где Ai — номер соединения в
списке возможных соединений (от 1 до M), а Ci задает категорию
кабеля и может принимать значения 5 или 6. Если планов несколько — выведите
любой из них.
Если
все квартиры соединить невозможно выведите слово Impossible.
***Пример***
|  |  |
| --- | --- |
| **Входные данные** | **Выходные данные** |
| 6 7  1 2 7  2 6 5  1 4 8  2 3 5  3 4 5  5 6 6  3 5 3  2 11 3 100 | 65  1 5  2 6  4 6  5 6  7 5 |
### Входные данные
### Выходные данные