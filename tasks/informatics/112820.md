---
title: "Задача №112820.  Подводная лодка"
tags:
  - problems/origin/informatics/112820
  - problem/contest/003302/E
---
# Задача №112820. Подводная лодка

Подводная лодка легла на грунт на мелководье. Для её обнаружения используются данные спутника, который с высокой точностью измеряет отклонение высоты поверхности воды от среднего уровня моря. Снимок, получаемый со спутника, представляет собой массив из
$h$ строк по w элементов в каждой строке.
![](/moodle_probpics/112820/всерос_остаток.JPG)
Введём на снимке систему координат с осью абсцисс, направленной вдоль строк снимка слева направо, и осью ординат, направленной вдоль столбцов снимка снизу вверх. Потенциальное изображение подводной лодки представляет собой любое множество элементов массива,
состоящее из следующих частей:
• «корпус» — полоса из элементов с координатами от $(x\_1, y\_1)$ до $(x\_2, y\_1)$, где $x\_1 \lt x\_2$;
• «рубка» — полоса из элементов с координатами от $(x\_3, y\_1)$ до $(x\_3, y\_2)$, где $x\_1 \le x\_3 \lt x\_2; y\_1 \le y\_2$;
• «хвост» — полоса из элементов с координатами от $(x\_4, y\_3)$ до $(x\_4, y\_4)$, где $x\_3 \lt x\_4 \le x\_2; y\_3 \le y\_1 \le y\_4$. Поскольку подводная лодка находится вблизи поверхности в районе с сильным течением, уровень воды над ней немного повышается.
Поэтому изображением подводной лодки на снимке будем считать потенциальное изображение с максимально возможной суммой входящих в него элементов массива.
Требуется написать программу, которая находит на снимке изображение подводной лодки и выводит сумму его элементов.
### Входные данные
Для сжатия передаваемых со спутника данных каждый элемент снимка кодируется строчной буквой английского алфавита. Первая строка входных данных содержит число $k$ — количество использованных для кодирования букв ($k \le 26$). Вторая строка входных
данных содержит $k$ целых чисел $c\_i$ — значения отклонений соответствующих каждому кодовому символу по порядку букв в английском алфавите от 1 до $k$-й.
Третья строка входных данных содержит числа $h$ и $w$ — размеры снимка. Последующие $h$ строк содержат по $w$ символов — кодовые значения элементов снимка.
### Выходные данные
Выходные данные должны содержать единственное целое число — сумму элементов массива, соответствующих изображению подводной лодки.
### Примеры
**Входные данные:**
```
3
-4 -3 4
5 5
bbabc
ccaac
accba
baccb
baaaa
```
**Выходные данные:**
```
16
```
**Входные данные:**
```
3
-2 4 0
5 5
abccb
cccac
cbcba
cccbb
accba
```
**Выходные данные:**
```
24
```
**Входные данные:**
```
4
-1 -5 -3 0
5 5
bbabc
ccaac
acdba
baccb
baaaa
```
**Выходные данные:**
```
-2
```