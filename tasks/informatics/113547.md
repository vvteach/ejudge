---
title: "Задача №113547. Путешествие в Метрополис"
tags:
  - problems/origin/informatics/113547
  - problem/contest/201806/D
  - problem/contest/201811/F
---
# Задача №113547. Путешествие в Метрополис

Путешествие по стране никогда не бывает простым, особенно когда не существует прямого сообщения между городами. Группа туристов хочет добраться в город Метрополис, используя сеть железных дорог, которая соединяет *n* городов, пронумерованных от 1 до *n*. Город, из которого выезжает группа, имеет номер 1, Метрополис имеет номер *n*.
На железной дороге постоянно функционируют *m* маршрутов поездов. Каждый маршрут определяется последовательностью городов, перечисленных в том порядке, в каком их проезжает поезд, обслуживающий этот маршрут. В каждом маршруте для каждой пары соседних городов задано время, за которое поезд этого маршрута проезжает перегон между этими городами. При этом поезда разных маршрутов могут проезжать один и тот же перегон за разное время.
По пути в Метрополис группа может садиться на поезд и сходить с поезда в любом городе маршрута, не обязательно в начальном или конечном. При этом, можно сойти с поезда маршрута *i*, пересесть на поезд маршрута *j*, возможно сделать еще несколько пересадок, а потом вновь сесть в поезд того же маршрута *i*.
Туристы предъявляют высокие требования к выбору способа проезда в Метрополис.
Во-первых, суммарное время, проведенное в поездах, должно быть минимальным.
Во-вторых, среди всех способов с минимальным временем нахождения в поездах предпочтительным является тот способ, для которого сумма квадратов промежутков времени, непрерывно проведенных в поезде между двумя пересадками, максимальна. Назовём эту сумму качеством путешествия.
Время, проведенное вне поездов, не учитывается.
Требуется написать программу, которая по описаниям имеющихся маршрутов поездов определит минимальное время, которое группе туристов придется провести в поездах, а также максимальное качество путешествия с таким временем.
### Входные данные
В первой строке входных данных заданы два целых числа (2 ≤ *n* ≤ 106, 1 ≤ *m* ≤ 106) — количество городов и количество маршрутов соответственно.
Далее в *m* строках содержится описание маршрутов.
Описание каждого маршрута начинается с целого числа *s**i*  — количество перегонов в маршруте с номером *i* (1 ≤ *s**i* ≤ 106). Далее следуют (2*s**i* + 1) целых чисел, описывающих города маршрута и время проезда перегона между соседними городами маршрута, в следующем порядке: *v**i*, 1, *t**i*, 1, *v**i*, 2, *t**i*, 2, *v**i*, 3, ..., *t**i*, *s**i*, *v**i*, *s**i* + 1, где *v**i*, *j* — номер *j*-го города маршрута, *t**i*, *j* — время проезда перегона между *j*-м и (*j* + 1)-м городом (1 ≤ *v**i*, *j* ≤ *n*, 1 ≤ *t**i*, *j* ≤ 1000).
Гарантируется, что *s*1 + *s*2 + ... + *s**m* ≤ 106. Никакие два города в описании маршрута не совпадают. Гарантируется, что с помощью имеющихся маршрутов можно добраться из города с номером 1 в город с номером *n*.
### Выходные данные
Выходные данные должны содержать два целых числа — минимальное суммарное время, которое придется провести в поездах, и максимальное качество пути с таким временем.
### Примеры
**Входные данные:**
```
2 1
1 1 3 2
```
**Выходные данные:**
```
3 9
```
**Входные данные:**
```
5 2
4 1 3 2 3 3 5 5 10 4
3 4 2 2 1 3 4 1
```
**Выходные данные:**
```
9 35
```
**Входные данные:**
```
5 2
3 1 1 2 2 3 3 4
3 2 2 3 3 4 4 5
```
**Выходные данные:**
```
10 82
```