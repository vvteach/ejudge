---
title: "Задача №111724. LCA"
tags:
  - problems/origin/informatics/111724
---
# Задача №111724. LCA

Задано подвешенное дерево, содержащее *n* (1 ≤ *n* ≤ 100 000) вершин, пронумерованных от 0 до *n* - 1. Требуется ответить на *m* (1 ≤ *m* ≤ 10 000 000) запросов о наименьшем общем предке для пары вершин. Запросы генерируются следующим образом. Заданы числа *a*1, *a*2 и числа *x*, *y* и *z*. Числа *a*3, ..., *a*2*m* генерируются следующим образом: *a**i* = ![](/moodle_probpics/111724/35315d0231b6c9f78ffdd1efdce6e6b45820bd4b.png). Первый запрос имеет вид {*a*1, *a*2}. Если ответ на (*i* - 1)-й запрос равен *v*, то *i*-й запрос имеет вид {![](/moodle_probpics/111724/111bef7a24e59b8bea761b5548965e2b577c8cb9.png), *a*2*i*}.
### Входные данные
Первая строка содержит два числа: *n* и *m*. Корень дерева имеет номер 0. Вторая строка содержит *n* - 1 целых чисел, *i*-е из этих чисел равно номеру родителя вершины *i*. Третья строка содержит число содержит два целых числа в диапазоне от 0 до *n* - 1: *a*1 и *a*2. Четвертая строка содержит три целых числа: *x*, *y* и *z*, эти числа неотрицательны и не превосходят 109.
### Выходные данные
Выведите в выходной файл сумму номеров вершин — ответов на все запросы.
### Примеры
**Входные данные:**
```
3 2
0 1
2 1
1 1 0
```
**Выходные данные:**
```
2
```