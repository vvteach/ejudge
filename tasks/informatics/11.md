---
title: "Задача №11. Казино"
tags:
  - problems/origin/informatics/11
  - problem/contest/202407/I
  - problem/contest/201908/A
  - problem/contest/201704/I
  - problem/contest/004606/I
---
# Задача №11. Казино

Вновь открытое казино предложило оригинальную игру.
В начале игры крупье выставляет в ряд несколько фишек разных цветов. Кроме того, он объявляет, какие последовательности фишек игрок может забирать себе в процессе игры. Далее игрок забирает себе одну из заранее объявленных последовательностей фишек, расположенных подряд. После этого крупье сдвигает оставшиеся фишки, убирая разрыв. Затем игрок снова забирает себе одну из объявленных последовательностей и так далее. Игра продолжается до тех пор, пока игрок может забирать фишки.
Рассмотрим пример. Пусть на столе выставлен ряд фишек **rrrgggbbb**,и крупье объявил последовательности **rg** и **gb**. Игрок, например, может забрать фишки **rg**, лежащие на третьем и четвёртом местах слева. После этого крупье сдвинет фишки, и на столе получится ряд **rrggbbb**. Ещё дважды забрав фишки **rg**, игрок добьётся того, что на столе останутся фишки **bbb**и игра закончится, так как игроку больше нечего забрать со стола. Игрок мог бы действовать и по-другому — на втором и третьем ходах забрать не последовательности **rg**, а последовательности **gb**. Тогда на столе остались бы фишки **rrb**. Аналогично, игрок мог бы добиться того, чтобы в конце остались ряды **rrr** или **rbb**.
После окончания игры полученные фишки игрок меняет на деньги. Цена фишки зависит от её цвета.
Требуется написать программу, определяющую максимальную сумму, которую сможет получить игрок.
### Входные данные
В первой строке входных данных содержится число *K* (1 ≤ *K* ≤ 26) — количество цветов фишек. Каждая из следующих *K* строк начинается со строчной латинской буквы, обозначающей цвет. Далее в той же строке через пробел следует целое число *X**i* (1 ≤ *X**i* ≤ 150, *i* = 1..*K*) — цена фишки соответствующего цвета.
В (*K*+2)-ой строке описан ряд фишек, лежащих на столе в начале игры. Ряд задается*L* строчными латинскими буквами (1 ≤ *L* ≤ 150), которые обозначают цвета фишек ряда.
В следующей строке содержится число *N*(1 ≤ *N* ≤ 150) — количество последовательностей, которые были объявлены крупье. В следующих *N* строках записаны эти последовательности. Гарантируется, что сумма длин этих *N* строк не превосходит 150 символов, и все они непустые.
### Выходные данные
Выведите единственное целое число — максимальную сумму денег, которую может получить игрок.
### Примеры
**Входные данные:**
```
3
v 3
l 1
u 2
luvu
3
luv
vul
uuu
```
**Выходные данные:**
```
6
```