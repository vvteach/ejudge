---
title: "Задача №2532. Ханты-Мансийск — Париж"
tags:
  - problems/origin/informatics/2532
  - problem/contest/003300/B
  - problem/contest/003200/B
---
# Задача №2532. Ханты-Мансийск — Париж

В 2050 году руководство Глобальной Телефонной Сети (ГТС) приняло решение о новой системе тарификации коротких текстовых сообщений. Теперь цена отправки одного сообщения зависит от количества совпадающих цифр в начале номеров телефонов отправителя и получателя. Если первые $c$ цифр телефонов совпадают, а $(c+1)$-я цифра различается, то стоимость сообщения составляет $(10-c)$ кредитов ($0\le c\le9$). Все номера телефонов — десятизначные. При этом ГТС разрешает каждому абоненту отправлять сообщение только в пределах часового пояса своего проживания или часовых поясов, отличающихся от него на 1 час.
Школьник Поликарп из Ханты-Мансийска (время +2 часа от московского) успешно решил все задания первого тура олимпиады школьников по информатике. Теперь он желает сообщить об этом в Париж (время −2 часа от московского) своему учителю — профессору де Коде́ру. Так как Ханты-Мансийск и Париж находятся не в соседних часовых поясах, Поликарп не может послать сообщение напрямую. Поэтому он пользуется тем, что у него есть друзья, которые проживают в Ханты-Мансийске, Париже, а также в промежуточных часовых поясах — в Дубае (время +1 час от московского), Москве и Калининграде (время −1 час от московского). Друзья Поликарпа по цепочке доставят профессору де Коде́ру столь важную информацию. Поликарп хочет организовать передачу информации таким образом, чтобы минимизировать суммарные расходы по отправке всех сообщений.
Напишите программу, определяющую цепочку доставки, для которой суммарная стоимость отправленных сообщений минимальна.
### Входные данные
Первые две строки входного файла содержат телефонные номера Поликарпа и профессора де Коде́ра. Далее следуют 5 блоков данных, описывающих друзей Поликарпа, живущих в Ханты-Мансийске, Дубае, Москве, Калининграде и Париже, соответственно. Каждый блок начинается со строки, содержащей одно число $n\_i$ ($1\le n\_i\le100\,000$) — количество друзей Поликарпа в соответствующем городе, после которой следуют $n\_i$ строк — номера телефонов друзей. Все номера телефонов состоят ровно из 10 цифр. Гарантируется, что сумма всех $n\_i$ не превосходит 100 000. Все номера телефонов во входных данных различны.
### Выходные данные
В первой строке выходного файла выведите минимальную возможную стоимость передачи информации $w$ и количество задействованных в цепочке телефонных номеров $k$. Далее выведите $k$ номеров телефонов, описывающих саму цепочку, в порядке следования от Поликарпа к профессору де Коде́ру. Первый номер в цепочке должен совпадать с номером телефона Поликарпа, а последний — с номером телефона профессора де Коде́ра. Если решений несколько, выведите любое.
***Система оценивания***
* Подзадача 0 (0 баллов) тесты из условия.
* Подзадача 1 (40 баллов) $ n \le 500$.
* Подзадача 2 (20 баллов) $ n \le 5000$. Необходимые подгруппы: 1.
* Подзадача 3 (40 баллов) Без дополнительных ограничений. Необходимые подгруппы: 1, 2.
### Примеры
**Входные данные:**
```
2099013166
7043239909
1
0258442145
1
0000000000
1
0000000001
1
0000000002
1
0147571204
```
**Выходные данные:**
```
22 5
2099013166
0000000000
0000000001
0000000002
7043239909
```
**Входные данные:**
```
4261802325
7967612531
1
8176476745
1
3084033164
1
1737248630
1
9447552231
1
2848478213
```
**Выходные данные:**
```
40 5
4261802325
3084033164
1737248630
9447552231
7967612531
```