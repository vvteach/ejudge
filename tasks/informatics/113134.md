---
title: "Задача №113134. Передача опыта"
tags:
  - problems/origin/informatics/113134
---
# Задача №113134. Передача опыта

Как известно, Берляндия — хорошо развитая страна, а поэтому в каждом городе есть школа. На недавнем съезде учителей стало ясно, что методики преподавания различных предметов во всех школах разные. Чтобы исправить это недоразумение, а также для улучшения качества образования было решено, что школам необходимо обмениваться опытом. Так как школы действительно разные, и у каждой имеется уникальный опыт, поступило предложение из каждой школы в каждую другую отправить делегата для перенимания опыта.
К сожалению, города в Берляндии находятся далеко друг от друга, поэтому их связывает минимальная возможная сеть дорог: из каждого города можно добраться по дорогам в любой другой не посещая ни один город дважды, но при этом лишь единственным способом. Также, еще большую проблему для учителей создает сложная система оплаты проезда по дорогам Берляндии.
Каждой дорогой владеет одна из
*K*
компаний, и для проезда по дорогам любой компании человек должен один раз купить проездной у этой компании. После этого он может проезжать по любым дорогам этой компании без дополнительной платы. Стоимость проездного
*i*
-ой компании (
1 ≤
*i*
≤
*K*
) равна
*c*
*i*
бурлей.
Каждому из делегатов нужно купить необходимые ему проездные. Помогите учителям посчитать, сколько же всего бурлей будут стоить все проездные для всех делегатов. Так как это число может быть большим, найдите остаток от деления этого числа на
1 000 000 007
(
10
9
+ 7
).
### Входные данные
В первой строке входных данных находятся два натуральных числа
*N*
и
*K*
(
1 ≤
*N*
≤ 1 500 000
,
1 ≤
*K*
≤ 1 500 000
) — число городов в Берляндии и число компаний-владельцев дорог соответственно. На следующих
(
*N*
- 1)
строках дано описание дорог Берляндии, на
*i*
-ой из этих строк (эти строки нумеруются с единицы, города тоже нумеруются с единицы) находятся два числа
*b*
*i*
и
*t*
*i*
(
1 ≤
*b*
*i*
≤
*N*
,
1 ≤
*t*
*i*
≤
*K*
), означающие, что существует дорога из города с номером
*i*
+ 1
в город с номером
*b*
*i*
, и владеет ей компания с номером
*t*
*i*
. По всем дорогам можно передвигаться в обе стороны; также, гарантируется, что из любого города можно добраться в любой другой по существующим дорогам.
На последней строке входных данных находятся 4 числа
*A*
,
*B*
,
*C*
,
*c*
0
(
1 ≤
*C*
≤ 1 000 000 001
,
0 ≤
*A*
,
*B*
,
*c*
0
<
*C*
), задающие стоимости проездных. Стоимости проездных вычисляются по формуле
![](/moodle_probpics/113134/13ec1fcaaf4dd0805a86661b806f319b26186433.png)
, где
*c*
*i*
"— стоимость проездного
*i*
-ой компании, а «
![](/moodle_probpics/113134/9fb33b3b4b24df24650af1660fa0453f21c16de3.png)
» — остаток от деления
*X*
на
*Y*
.
### Выходные данные
Выведите единственное число — остаток от деления суммарной стоимости необходимых проездных на
1 000 000 007
.
### Примеры
**Входные данные:**
```
3 2
1 1
2 2
1 2 100 1
```
**Выходные данные:**
```
32
```
**Входные данные:**
```
3 1
1 1
2 1
1 2 100 1
```
**Выходные данные:**
```
18
```