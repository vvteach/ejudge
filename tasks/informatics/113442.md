---
title: "Задача №113442.  Полезные ископаемые"
tags:
  - problems/origin/informatics/113442
  - problem/contest/202711/D
  - problem/contest/204605/D
---
# Задача №113442. Полезные ископаемые

Ведется проект по освоению планеты соседней звездной системы. Для добычи
полезных ископаемых планируется направить на планету несколько партий роботов.
Участок поверхности планеты, на котором планируется добывать полезные
ископаемые, представляет собой клетчатый прямоугольник размером $w$ на $h$, клетки участка
имеют координаты от (1, 1) до $(w, h)$. В некоторых клетках участка находятся базы
специалистов, в которые могут быть доставлены партии роботов. Всего на участке
размещено $s$ баз, и $i$-я база находится в клетке с координатами \((x\_i
, y\_i)\).
Каждая партия роботов характеризуется тремя параметрами: $j$-я партия доставляется
на базу $b\_j$
, содержит $n\_j$ роботов и каждый робот партии обладает мобильностью $m\_j$
.
Когда партия роботов доставляется на соответствующую базу, каждый робот этой
партии перемещается по поверхности планеты от базы до некоторой клетки. Если
мобильность робота равна $m$, он может не более $m$ раз переместиться на одну из восьми
соседних клеток, как показано на рис. 1.
![](/113442/4_1.JPG)
После того как роботы из всех доставленных партий размещаются на участке, они
активируются и начинают добычу полезных ископаемых. В процессе перемещения в одной
клетке может одновременно находиться произвольное количество роботов. Однако после
активации в каждой клетке должно находиться не более $q$ роботов.
Руководством проекта получена информация о $t$ партиях роботов, которые могут быть
последовательно отправлены на планету. После доставки всех партий роботов, учитывая их
ограниченную мобильность, возможна ситуация, что не удастся разместить роботов на
участке так, чтобы в каждой клетке оказалось не больше $q$ роботов. Поэтому руководство
должно выбрать $k$ первых партий роботов, где $0 \le k \le t$, которые будут полностью
доставлены на соответствующие базы. После этого, если $k < t$, следует дополнительно
принять $z$ из $n\_{k + 1}$ роботов следующей, ($k + 1$)-й партии, $0 \le z < n\_{k + 1}$.
Все полученные таким образом роботы должны с учетом ограничения на мобильность
разместиться на участке таким образом, чтобы в каждой клетке было не более $q$ роботов.
После этого они будут активированы и начнут добычу полезных ископаемых. Разумеется,
руководство проекта старается максимизировать количество роботов, которые будут
доставлены на планету, поэтому, с учетом описанных ограничений, требуется
максимизировать $k$, а затем максимизировать $z$.
Требуется написать программу, которая по размерам участка, числу $q$, описанию
расположения баз, а также количеству запланированных партий роботов и их описанию
определяет максимальное число $k$ — количество партий роботов, и затем – максимальное
число $z$ – дополнительное количество роботов из ($k + 1$)-й партии, чтобы, доставив роботов
на планету, их можно было разместить на участке таким образом, чтобы в каждой клетке
оказалось не более $q$ роботов.
### Входные данные
Первая строка входного файла содержит числа $w$, $h$, $s$ и $q$ (\(1 \le w, h \le 10^5
, 1 \le s \le 4,
1 \le q \le 100\)). Последующие $s$ строк содержат по два целых числа \(x\_i
, y\_i\) и описывают базы
специалистов ($1 \le x\_i \le w, 1 \le y\_i \le h$).
Следующая строка содержит число $t$ — количество партий роботов ($1 \le t \le 100$).
Последующие $t$ строк описывают партии роботов и содержат по 3 целых числа: \(b\_j
, n\_j\) и $m\_j$
($1 \le b\_j \le s, 1 \le n\_j \le w \cdot h \cdot q, 0 \le m\_j < max(w, h)$ ).
### Выходные данные
Требуется вывести два числа: $k$ и $z$, $0 \le k \le t$. Если $k = t$, то $z$ должно быть равно 0,
иначе должно выполняться условие $0 \le z < n\_{k + 1}$.
### Примеры
**Входные данные:**
```
4 3 2 1
1 1
3 2
3
1 4 1
2 9 1
1 12 2
```
**Выходные данные:**
```
1 7
```