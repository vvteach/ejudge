---
title: "Задача №111636. Древние династии"
tags:
  - problems/origin/informatics/111636
  - problem/contest/201816/D
---
# Задача №111636. Древние династии

История Татаро-монгольского ханства богата на правителей. Каждый из *N* правителей принадлежал к одной из двух династий, причём власть часто переходила от одной династии к другой. Каждое восхождение правителя на престол отмечалось праздником, проводимым 26 марта. В летописях зафиксированы годы проведения этих праздников, причем известно, что правители первой династии устраивали для народа праздник кумыса, а второй — праздник мёда.
На конференции по истории Татаро-монгольского ханства каждый из *S* учёных предложил свою версию толкования летописи. А именно, *i*-й историк утверждал, что от каждого праздника кумыса до следующего праздника кумыса проходило не менее *KL**i* лет, но не более *KR**i* лет, в то время как от каждого праздника мёда до следующего праздника мёда проходило не менее *ML**i* лет, но не более *MR**i* лет.
Каждой предложенной версии может соответствовать несколько распределений правителей по династиям. Ученые договорились считать показателем сомнительности распределения число переходов власти к представителю той же самой династии.
Требуется написать программу, которая найдёт распределение, соответствующее хотя бы одной из версий и имеющее наименьший показатель сомнительности, а также версию, которой оно соответствует.
### Входные данные
В первой строке входного файла записано число *N* (2 ≤ *N* ≤ 200 000) — количество праздников в летописи. Следующая строка содержит целые числа *X*1, *X*2, ..., *X**N* (1 ≤ *X*1 ≤ *X*2 ≤ ... ≤ *X**N* ≤ 109) — годы проведения праздников.
В третьей строке записано число учёных *S* (1 ≤ *S* ≤ 50). В каждой из последующих *S* строк записаны четыре натуральных числа *KL**i*, *KR**i*, *ML**i*, *MR**i* (1 ≤ *KL**i* ≤ *KR**i* ≤ 109), (1 ≤ *ML**i* ≤ *MR**i* ≤ 109).
### Выходные данные
Первая строка выходного файла должна содержать числа *P* и *Q*, где *P* — номер учёного, версии которого соответствует распределение с наименьшим показателем сомнительности, а *Q* — показатель сомнительности этого распределения.
Вторая строка должна состоять из *N* цифр 1 и 2, записанных без пробелов, означающих приход к власти представителя первой или второй династии соответственно. Если существует несколько решений с наименьшим показателем сомнительности *Q*, выведите любое из них.
В случае, если ни в одной из версий учёных не существует способа распределения периодов правления между династиями так, чтобы не нарушались ограничения на промежутки времени между праздниками, выходной файл должен содержать единственное число 0.
### Примеры
**Входные данные:**
```
3
1 2 3
1
1 1 1 1
```
**Выходные данные:**
```
1 1
211
```
**Входные данные:**
```
4
1 6 9 13
2
1 2 2 3
6 7 3 3
```
**Выходные данные:**
```
0
```
**Входные данные:**
```
5
3 6 8 9 10
2
2 3 1 1
1 4 1 10
```
**Выходные данные:**
```
2 0
21212
```