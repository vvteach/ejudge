---
title: "Задача №112746. Река"
tags:
  - problems/origin/informatics/112746
  - problem/contest/030512/A
  - problem/contest/202707/C
  - problem/contest/029512/A
  - problem/contest/204201/D
---
# Задача №112746. Река

Во Флатландии протекает богатая рыбой река Большой Флат. Много лет назад река была поделена между $n$ рыболовными предприятиями, каждое из которых получило непрерывный отрезок реки. При этом $i$-е предприятие, если рассматривать их по порядку, начиная
от истока, изначально получило отрезок реки длиной $a\_i$ .
  
  
 С тех пор с рыболовными предприятиями во Флатландии k раз происходили различные события. Каждое из событий было одного из двух типов: банкротство некоторого предприятия или разделение некоторого предприятия на два.  
  
 При некоторых
событиях отрезок реки, принадлежащий предприятию, с которым это событие происходит, делится на две части. Каждый такой отрезок имеет длину большую или равную 2. Деление происходит по следующему правилу. Если отрезок имеет четную длину, то
он делится на две равные части. Иначе он делится на две части, длины которых различаются ровно на единицу, при этом часть, которая ближе к истоку реки, имеет меньшую длину.  
  
 При банкротстве предприятия происходит следующее. Отрезок
реки, принадлежавший обанкротившемуся предприятию, переходит к его соседям. Если у обанкротившегося предприятия один сосед, то этому соседу целиком передается отрезок реки обанкротившегося предприятия. Если же соседей двое, то отрезок реки
делится на две части описанным выше способом, после чего каждый из соседей присоединяет к своему отрезку ближайшую к нему часть.  
  
 При разделении предприятия отрезок реки, принадлежавший разделяемому предприятию, всегда делится на две
части описанным выше способом. Разделившееся предприятие ликвидируется, и образуются два новых предприятия. Таким образом, после каждого события каждое предприятие владеет некоторым отрезком реки.  
  
 Министерство финансов Флатландии предлагает
ввести налог на рыболовные предприятия, пропорциональный квадрату длины отрезка реки, принадлежащего соответствующему предприятию. Чтобы проанализировать, как будет работать этот налог, министр хочет по имеющимся данным узнать, как изменялась
величина, равная сумме квадратов длин отрезков реки, принадлежащих предприятиям, после каждого произошедшего события.  
  
 Требуется написать программу, которая по заданному начальному разделению реки между предприятиями и списку событий,
происходивших с предприятиями, определит, чему равна сумма квадратов длин отрезков реки, принадлежащих предприятиям, в начальный момент времени и после каждого события.
### Входные данные
Первая строка входного файла содержит два целых числа: $n$ и $p$ — исходное количество предприятий (2 ≤ $n$ ≤ 100 000) и номер подзадачи (0 ≤ $p$ ≤ 4).  
  
 Вторая строка входного файла содержит $n$ целых чисел $a\_1$, $a\_2$,
…, $a\_n$ — длины исходных отрезков реки.  
  
 Третья строка входного файла содержит целое число $k$ — количество событий, происходивших с предприятиями (1 ≤ $k$ ≤ 100 000).  
  
 Последующие $k$ строк содержат описания событий,
$i$-я строка содержит два целых числа: $e\_i$ и $v\_i$ — тип события и номер предприятия, с которым оно произошло. Значение $e\_i$ = 1 означает, что предприятие, которое после всех предыдущих событий является $v\_i$-м по порядку, если
считать с единицы от истока реки, обанкротилось, а значение $e\_i$ = 2 означает, что это предприятие разделилось на два.  
  
 Гарантируется, что значение $v\_i$ не превышает текущее количество предприятий. Гарантируется, что если отрезок
предприятия при банкротстве или разделении требуется поделить на две части, то он имеет длину большую или равную 2. Гарантируется, что если на реке осталось единственное предприятие, оно не банкротится.
### Выходные данные
Выходной файл должен содержать ($k$ + 1) целых чисел, по одному в строке. Первая строка должна содержать исходную сумму квадратов длин отрезков реки, а каждая из последующих $k$ строк — сумму квадратов длин отрезков реки после очередного события.
### Примеры
**Входные данные:**
```
4 0
3 5 5 4
5
1 1
2 1
1 3
2 2
1 3
```
**Выходные данные:**
```
75
105
73
101
83
113
```