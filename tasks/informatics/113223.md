---
title: "Задача №113223. Курьерская служба"
tags:
  - problems/origin/informatics/113223
  - problem/contest/004103/E
  - problem/contest/200612/D
---
# Задача №113223. Курьерская служба

В корпорации работают $n$ сотрудников, один из которых является директором. У каждого сотрудника, кроме директора, имеется ровно один непосредственный руководитель.
Каждый сотрудник выполняет свою строго определённую работу. Если сотруднику a требуется выполнить работу, которой занимается сотрудник $b$, то он должен отправить сотруднику $b$ заявку. Согласно корпоративной политике напрямую заявки могут передаваться
только либо от сотрудника его непосредственному руководителю, либо наоборот — от руководителя к непосредственному подчинённому. Заявка передается от сотрудника к сотруднику до тех пор, пока не достигнет сотрудника $b$.
Чтобы разгрузить сотрудников, корпорация наняла $k$ курьеров. Курьер с номером $i$ закреплён за парой сотрудников $a\_i$ и $b\_i$ и занимается доставкой заявок между ними. Если одному сотруднику из этой пары требуется передать заявку другому, то
он отдает заявку курьеру, который последовательно передает заявку между сотрудниками в соответствии с корпоративной политикой, пока заявка не пройдет всех необходимых промежуточных сотрудников и окажется доставленной адресату. В процессе доставки
одной заявки курьер не посещает одного и того же сотрудника более одного раза.
С целью оптимизации расходов решено найти пару курьеров, пути следования которых перекрываются наиболее сильно, и отказаться от услуг одного из них, поручив его работу второму. Назовём
*степенью дублирования* для пары курьеров количество переходов между сотрудником и его непосредственным начальником в любом направлении, входящих в путь как первого, так и второго курьера.
Требуется написать программу, которая определит двух курьеров с наибольшей степенью дублирования.
### Входные данные
Первая строка входных данных содержит два целых числа: $n$ — количество сотрудников и $k$ — количество курьеров ($2 \le n, k \le 2 \cdot 10^5$ ). Сотрудники пронумерованы от 1 до n, директор имеет номер 1.
Вторая строка содержит ($n − 1$) целых чисел: $p\_2, p\_3, \dots, p\_n$ — номера непосредственных руководителей каждого сотрудника, кроме директора ($1 \le p\_i < i$).
Следующие $k$ строк содержат по два целых числа: $a\_i$ и $b\_i$ — номера сотрудников в паре, за которой закреплён курьер с номером $i$ ($1 \le a\_i, b\_i \le n; a\_i ̸ \ne b\_i$). За одной и той же парой сотрудников может быть закреплено несколько
курьеров.
### Выходные данные
Первая строка выходных данных должна содержать единственное целое число — наибольшую степень дублирования двух курьеров.
Вторая строка выходных данных должна содержать два различных целых числа от 1 до $k$ — номера курьеров, входящих в пару с наибольшей степенью дублирования. Если таких пар несколько, можно вывести любую из них.
### Примеры
**Входные данные:**
```
4 2
1 2 2
1 3
1 4
```
**Выходные данные:**
```
1
2 1
```
**Входные данные:**
```
4 2
1 2 3
1 2
3 4
```
**Выходные данные:**
```
0
1 2
```
**Входные данные:**
```
7 3
1 2 2 4 5 5
1 3
3 7
6 1
```
**Выходные данные:**
```
2
2 3
```
**Входные данные:**
```
4 3
1 2 3
1 4
4 1
1 4
```
**Выходные данные:**
```
3
2 1
```