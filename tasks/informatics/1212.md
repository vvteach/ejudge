---
title: "Задача №1212. Перестановки"
tags:
  - problems/origin/informatics/1212
  - problem/contest/201612/E
  - problem/contest/201802/C
  - problem/contest/202405/C
  - problem/contest/029215/I
  - problem/contest/030413/I
  - problem/contest/030706/E
  - problem/contest/202300/A
  - problem/contest/204411/A
  - problem/contest/029413/5E
  - problem/contest/202409/C
  - problem/contest/030607/D
  - problem/contest/030309/A
---
# Задача №1212. Перестановки

Задано множество из *n* различных натуральных чисел. Перестановку элементов этого множества назовем *k-перестановкой*, если для любых двух соседних элементов этой перестановки их наибольший общий делитель не менее *k*. Например, если задано множество элементов *S* = {6, 3, 9, 8}, то перестановка {8, 6, 3, 9} является *2-перестановкой*, а перестановка {6, 8, 3, 9} – нет.
Перестановка {*p*1, *p*2, …, *p**n*} будет *лексикографически меньше* перестановки {*q*1, *q*2, …, *q**n*}, если существует такое натуральное число *i* (1 ≤ *i* ≤ *n*), для которого *p**j =* *q**j* при *j <* *i* и *p**i <* *q**i*.
В качестве примера упорядочим все *k-перестановки за*данного выше множества в лексикографическом порядке. Например, существует ровно четыре *2-перестановки* множества *S*: {3, 9, 6, 8}, {8, 6, 3, 9}, {8, 6, 9, 3} и {9, 3, 6, 8}. Соответственно, первой *2-перестановкой* в лексикографическом порядке является множество {3, 9, 6, 8}, а четвертой – множество {9, 3, 6, 8}.
Требуется написать программу, позволяющую найти *m*-ую *k-перестановку* в этом порядке.
### Входные данные
Входной файл в первой строке содержит три натуральных числа – *n* (1≤*n*≤16), *m* и *k (*1*≤**m,**k ≤*109*)*. Вторая строка содержит *n* различных натуральных чисел, не превосходящих 109. Все числа в строках разделены пробелом.
### Выходные данные
В выходной файл необходимо вывести *m*-ую *k*-перестановку заданного множества или –1, если такой нет.
***Разбалловка для личной олимпиады***
Тесты 1-3 — из условия. Оцениваются в 0 баллов.
Тесты 4-17 — $n\le 4$. Группа тестов оценивается в 28 баллов.
Тесты 18-28 — $n\le 10$. Группа тестов оценивается в 22 балла (вместе с предыдущей группой — 50 баллов).
Тесты 29-53 — дополнительных ограничений нет. Группа тестов оценивается в 50 баллов (вместе с предыдущими группами — 100 баллов).
Баллы начисляются за прохождение всех тестов группы и всех тестов предыдущих групп. При выставлении баллов за отдельные тесты каждый тест (кроме тестов из условия) оценивается в 2 балла.
### Примеры
**Входные данные:**
```
4 1 2
6 8 3 9
```
**Выходные данные:**
```
3 9 6 8
```
**Входные данные:**
```
4 4 2
6 8 3 9
```
**Выходные данные:**
```
9 3 6 8
```
**Входные данные:**
```
4 5 2
6 8 3 9
```
**Выходные данные:**
```
-1
```