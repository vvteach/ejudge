---
title: "Задача №111796. LCA"
tags:
  - problems/origin/informatics/111796
  - problem/contest/004103/A
  - problem/contest/300611/A
  - problem/contest/031301/D
  - problem/contest/200300/Q
  - problem/contest/200612/A
---
# Задача №111796. LCA

Задано подвешенное дерево, содержащее *n* (1 ≤ *n* ≤ 100000) вершин, пронумерованных от 0 до *n* - 1. Требуется ответить на *m* (1 ≤ *m* ≤ 100000) запросов о наименьшем общем предке для пары вершин.
Запросы генерируются следующим образом. Заданы числа *a*1, *a*2 и числа *x*, *y* и *z*. Числа *a*3, ..., *a*2*m* генерируются следующим образом: *a**i* = (*x*·*a**i* - 2 + *y*·*a**i* - 1 + *z*)*mod*: *n*. Первый запрос имеет вид (*a*1, *a*2). Если ответ на (*i* - 1)-й запрос равен *v*, то *i*-й запрос имеет вид ((*a*2*i* - 1 + *v*)*mod*: *n*, *a*2*i*).
### Входные данные
Первая строка содержит два числа: *n* и *m*. Корень дерева имеет номер 0. Вторая строка содержит *n* - 1 целых чисел, *i*-е из этих чисел равно номеру родителя вершины *i*. Третья строка содержит число содержит два целых числа в диапазоне от 0 до *n* - 1: *a*1 и *a*2. Четвертая строка содержит три целых числа: *x*, *y* и *z*, эти числа неотрицательны и не превосходят 109.
### Выходные данные
Выведите в выходной файл сумму номеров вершин — ответов на все запросы.
### Примеры
**Входные данные:**
```
3 2
0 1
2 1
1 1 0
```
**Выходные данные:**
```
2
```